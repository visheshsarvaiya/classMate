"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.initializeJSONLogger = initializeJSONLogger;
const index_1 = require("../../redux/index");
const strip_ansi_1 = __importDefault(require("strip-ansi"));
const lodash_clonedeep_1 = __importDefault(require("lodash.clonedeep"));
const isStringPayload = (action) => typeof action.payload === `string`;
const sanitizeAction = (action) => {
    const copiedAction = (0, lodash_clonedeep_1.default)(action);
    if (isStringPayload(copiedAction)) {
        return copiedAction;
    }
    if (`text` in copiedAction.payload && copiedAction.payload.text) {
        copiedAction.payload.text = (0, strip_ansi_1.default)(copiedAction.payload.text);
    }
    if (`statusText` in copiedAction.payload && copiedAction.payload.statusText) {
        copiedAction.payload.statusText = (0, strip_ansi_1.default)(copiedAction.payload.statusText);
    }
    return copiedAction;
};
function initializeJSONLogger() {
    (0, index_1.onLogAction)((action) => {
        const sanitizedAction = sanitizeAction(action);
        process.stdout.write(JSON.stringify(sanitizedAction) + `\n`);
    });
}
//# sourceMappingURL=index.js.map